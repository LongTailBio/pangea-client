import * as React from 'react';
import * as d3 from 'd3';
import * as Highcharts from 'highcharts';
import sunburst from '../../../../../../../node_modules/highcharts/modules/sunburst';
import { Row, Col } from 'react-bootstrap';

import { SampleTaxonomyType } from '../../../../services/api/models/queryResult';

import { ChartRefProps } from '../../../components/DisplayContainer/highcharts';
import HighChartsPlot from '../../../plots/HighChartsPlot';

import SampleTaxonomyControls from './components/SampleTaxonomyControls';

sunburst(Highcharts);  // this is a weird highcharts thing see https://www.highcharts.com/blog/frameworks/react/192-use-highcharts-to-create-charts-in-react/



var data = [{'id': 'root', 'name': 'root', 'parent': '', 'value': 100}, {'name': 'Bacteria', 'id': 'Bacteria', 'parent': 'root', 'value': 100.00000000000001}, {'name': 'Actinobacteria', 'id': 'Actinobacteria', 'parent': 'Bacteria', 'value': 67.75325514821314}, {'name': 'Propionibacteriales', 'id': 'Propionibacteriales', 'parent': 'Actinobacteria', 'value': 52.507156708837385}, {'name': 'Propionibacteriaceae', 'id': 'Propionibacteriaceae', 'parent': 'Propionibacteriales', 'value': 52.00387847446672}, {'name': 'Cutibacterium', 'id': 'Cutibacterium', 'parent': 'Propionibacteriaceae', 'value': 51.325145442792504}, {'name': 'Cutibacterium_acnes', 'id': 'Cutibacterium_acnes', 'parent': 'Cutibacterium', 'value': 50.12466525071568}, {'name': 'Cutibacterium_acnes_subsp_acnes', 'id': 'Cutibacterium_acnes_subsp_acnes', 'parent': 'Cutibacterium_acnes', 'value': 0.14313417674762213}, {'name': 'Cutibacterium_acnes_subsp_defendens', 'id': 'Cutibacterium_acnes_subsp_defendens', 'parent': 'Cutibacterium_acnes', 'value': 0.10157909317573183}, {'name': 'Cutibacterium_granulosum', 'id': 'Cutibacterium_granulosum', 'parent': 'Cutibacterium', 'value': 0.9557669221534769}, {'name': 'Cutibacterium_avidum', 'id': 'Cutibacterium_avidum', 'parent': 'Cutibacterium', 'value': 0.09696186166774402}, {'name': 'Propionibacterium', 'id': 'Propionibacterium', 'parent': 'Propionibacteriaceae', 'value': 0.2077754178594515}, {'name': 'Propionibacterium_sp_oral_taxon_193', 'id': 'Propionibacterium_sp_oral_taxon_193', 'parent': 'Propionibacterium', 'value': 0.19392372333548805}, {'name': 'Nocardioidaceae', 'id': 'Nocardioidaceae', 'parent': 'Propionibacteriales'}, {'name': 'Nocardioides', 'id': 'Nocardioides', 'parent': 'Nocardioidaceae'}, {'name': 'Nocardioides_dokdonensis', 'id': 'Nocardioides_dokdonensis', 'parent': 'Nocardioides', 'value': 0.15236863976359777}, {'name': 'Micrococcales', 'id': 'Micrococcales', 'parent': 'Actinobacteria', 'value': 6.5795548988826305}, {'name': 'Micrococcaceae', 'id': 'Micrococcaceae', 'parent': 'Micrococcales', 'value': 5.185150983470312}, {'name': 'Micrococcus', 'id': 'Micrococcus', 'parent': 'Micrococcaceae', 'value': 4.123187736633115}, {'name': 'Micrococcus_luteus', 'id': 'Micrococcus_luteus', 'parent': 'Micrococcus', 'value': 4.123187736633115}, {'name': 'Rothia', 'id': 'Rothia', 'parent': 'Micrococcaceae', 'value': 0.512512697386647}, {'name': 'Rothia_mucilaginosa', 'id': 'Rothia_mucilaginosa', 'parent': 'Rothia', 'value': 0.44787145627481767}, {'name': 'Rothia_dentocariosa', 'id': 'Rothia_dentocariosa', 'parent': 'Rothia', 'value': 0.06464124111182935}, {'name': 'Kocuria', 'id': 'Kocuria', 'parent': 'Micrococcaceae', 'value': 0.3093545110351833}, {'name': 'Kocuria_rhizophila', 'id': 'Kocuria_rhizophila', 'parent': 'Kocuria', 'value': 0.18007202881152462}, {'name': 'Kocuria_palustris', 'id': 'Kocuria_palustris', 'parent': 'Kocuria', 'value': 0.060024009603841535}, {'name': 'Microbacteriaceae', 'id': 'Microbacteriaceae', 'parent': 'Micrococcales'}, {'name': 'Microbacterium', 'id': 'Microbacterium', 'parent': 'Microbacteriaceae'}, {'name': 'Microbacterium_aurum', 'id': 'Microbacterium_aurum', 'parent': 'Microbacterium', 'value': 0.050789546587865914}, {'name': 'Microbacterium_sp_CGR1', 'id': 'Microbacterium_sp_CGR1', 'parent': 'Microbacterium', 'value': 0.009234463015975622}, {'name': 'Intrasporangiaceae', 'id': 'Intrasporangiaceae', 'parent': 'Micrococcales', 'value': 0.32782343706713457}, {'name': 'Janibacter', 'id': 'Janibacter', 'parent': 'Intrasporangiaceae', 'value': 0.23547880690737835}, {'name': 'Janibacter_indicus', 'id': 'Janibacter_indicus', 'parent': 'Janibacter', 'value': 0.23547880690737835}, {'name': 'Dermabacteraceae', 'id': 'Dermabacteraceae', 'parent': 'Micrococcales'}, {'name': 'Dermabacter', 'id': 'Dermabacter', 'parent': 'Dermabacteraceae', 'value': 0.09696186166774402}, {'name': 'Dermabacter_vaginalis', 'id': 'Dermabacter_vaginalis', 'parent': 'Dermabacter', 'value': 0.09696186166774402}, {'name': 'Dermacoccaceae', 'id': 'Dermacoccaceae', 'parent': 'Micrococcales', 'value': 0.13389971373164652}, {'name': 'Kytococcus', 'id': 'Kytococcus', 'parent': 'Dermacoccaceae', 'value': 0.0831101671437806}, {'name': 'Kytococcus_sedentarius', 'id': 'Kytococcus_sedentarius', 'parent': 'Kytococcus', 'value': 0.0831101671437806}, {'name': 'Corynebacteriales', 'id': 'Corynebacteriales', 'parent': 'Actinobacteria'}, {'name': 'Corynebacteriaceae', 'id': 'Corynebacteriaceae', 'parent': 'Corynebacteriales', 'value': 4.89426539846708}, {'name': 'Corynebacterium', 'id': 'Corynebacterium', 'parent': 'Corynebacteriaceae', 'value': 4.89426539846708}, {'name': 'Corynebacterium_ureicelerivorans', 'id': 'Corynebacterium_ureicelerivorans', 'parent': 'Corynebacterium', 'value': 0.586388401514452}, {'name': 'Corynebacterium_singulare', 'id': 'Corynebacterium_singulare', 'parent': 'Corynebacterium', 'value': 0.5402160864345739}, {'name': 'Corynebacterium_aurimucosum', 'id': 'Corynebacterium_aurimucosum', 'parent': 'Corynebacterium', 'value': 0.4709576138147567}, {'name': 'Corynebacterium_striatum', 'id': 'Corynebacterium_striatum', 'parent': 'Corynebacterium', 'value': 0.4247852987348786}, {'name': 'Corynebacterium_simulans', 'id': 'Corynebacterium_simulans', 'parent': 'Corynebacterium', 'value': 0.3786129836550005}, {'name': 'Corynebacterium_imitans', 'id': 'Corynebacterium_imitans', 'parent': 'Corynebacterium', 'value': 0.18007202881152462}, {'name': 'Corynebacterium_camporealensis', 'id': 'Corynebacterium_camporealensis', 'parent': 'Corynebacterium', 'value': 0.16160310277957338}, {'name': 'Corynebacterium_kroppenstedtii', 'id': 'Corynebacterium_kroppenstedtii', 'parent': 'Corynebacterium', 'value': 0.13851694523963434}, {'name': 'Corynebacterium_flavescens', 'id': 'Corynebacterium_flavescens', 'parent': 'Corynebacterium', 'value': 0.12004801920768307}, {'name': 'Corynebacterium_glaucum', 'id': 'Corynebacterium_glaucum', 'parent': 'Corynebacterium', 'value': 0.10157909317573183}, {'name': 'Corynebacterium_resistens', 'id': 'Corynebacterium_resistens', 'parent': 'Corynebacterium', 'value': 0.06925847261981717}, {'name': 'Corynebacterium_sp_ATCC_6931', 'id': 'Corynebacterium_sp_ATCC_6931', 'parent': 'Corynebacterium', 'value': 0.03232062055591468}, {'name': 'Mycobacteriaceae', 'id': 'Mycobacteriaceae', 'parent': 'Corynebacteriales'}, {'name': 'Mycobacterium', 'id': 'Mycobacterium', 'parent': 'Mycobacteriaceae'}, {'name': 'Mycobacterium_avium', 'id': 'Mycobacterium_avium', 'parent': 'Mycobacterium'}, {'name': 'Mycobacterium_avium_subsp_hominissuis', 'id': 'Mycobacterium_avium_subsp_hominissuis', 'parent': 'Mycobacterium_avium', 'value': 0.013851694523963431}, {'name': 'Mycobacterium_bovis', 'id': 'Mycobacterium_bovis', 'parent': 'Mycobacterium', 'value': 0.018468926031951244}, {'name': 'Mycobacterium_sp_KMS', 'id': 'Mycobacterium_sp_KMS', 'parent': 'Mycobacterium', 'value': 0.009234463015975622}, {'name': 'Nocardiaceae', 'id': 'Nocardiaceae', 'parent': 'Corynebacteriales'}, {'name': 'Rhodococcus', 'id': 'Rhodococcus', 'parent': 'Nocardiaceae'}, {'name': 'Rhodococcus_sp_PBTS_2', 'id': 'Rhodococcus_sp_PBTS_2', 'parent': 'Rhodococcus', 'value': 0.013851694523963431}, {'name': 'Gordoniaceae', 'id': 'Gordoniaceae', 'parent': 'Corynebacteriales', 'value': 0.23086157539939053}, {'name': 'Gordonia', 'id': 'Gordonia', 'parent': 'Gordoniaceae', 'value': 0.23086157539939053}, {'name': 'Gordonia_bronchialis', 'id': 'Gordonia_bronchialis', 'parent': 'Gordonia', 'value': 0.13851694523963434}, {'name': 'Lawsonella', 'id': 'Lawsonella', 'parent': 'Corynebacteriales', 'value': 0.06464124111182935}, {'name': 'Lawsonella_clevelandensis', 'id': 'Lawsonella_clevelandensis', 'parent': 'Lawsonella', 'value': 0.06464124111182935}, {'name': 'Pseudonocardiales', 'id': 'Pseudonocardiales', 'parent': 'Actinobacteria'}, {'name': 'Pseudonocardiaceae', 'id': 'Pseudonocardiaceae', 'parent': 'Pseudonocardiales'}, {'name': 'Pseudonocardia', 'id': 'Pseudonocardia', 'parent': 'Pseudonocardiaceae'}, {'name': 'Pseudonocardia_sp_AL041005-10', 'id': 'Pseudonocardia_sp_AL041005-10', 'parent': 'Pseudonocardia', 'value': 0.03693785206390249}, {'name': 'Bifidobacteriales', 'id': 'Bifidobacteriales', 'parent': 'Actinobacteria'}, {'name': 'Bifidobacteriaceae', 'id': 'Bifidobacteriaceae', 'parent': 'Bifidobacteriales'}, {'name': 'Gardnerella', 'id': 'Gardnerella', 'parent': 'Bifidobacteriaceae', 'value': 0.23086157539939053}, {'name': 'Gardnerella_vaginalis', 'id': 'Gardnerella_vaginalis', 'parent': 'Gardnerella', 'value': 0.23086157539939053}, {'name': 'Actinomycetales', 'id': 'Actinomycetales', 'parent': 'Actinobacteria'}, {'name': 'Actinomycetaceae', 'id': 'Actinomycetaceae', 'parent': 'Actinomycetales'}, {'name': 'Actinomyces', 'id': 'Actinomyces', 'parent': 'Actinomycetaceae', 'value': 0.2123926493674393}, {'name': 'Actinomyces_oris', 'id': 'Actinomyces_oris', 'parent': 'Actinomyces', 'value': 0.13851694523963434}, {'name': 'Actinomyces_meyeri', 'id': 'Actinomyces_meyeri', 'parent': 'Actinomyces', 'value': 0.013851694523963431}, {'name': 'Firmicutes', 'id': 'Firmicutes', 'parent': 'Bacteria', 'value': 9.774679102410195}, {'name': 'Bacilli', 'id': 'Bacilli', 'parent': 'Firmicutes', 'value': 9.340659340659341}, {'name': 'Bacillales', 'id': 'Bacillales', 'parent': 'Bacilli', 'value': 7.096684827777265}, {'name': 'Staphylococcaceae', 'id': 'Staphylococcaceae', 'parent': 'Bacillales', 'value': 6.773478622218119}, {'name': 'Staphylococcus', 'id': 'Staphylococcus', 'parent': 'Staphylococcaceae', 'value': 6.755009696186168}, {'name': 'Staphylococcus_epidermidis', 'id': 'Staphylococcus_epidermidis', 'parent': 'Staphylococcus', 'value': 3.9754363283775054}, {'name': 'Staphylococcus_capitis', 'id': 'Staphylococcus_capitis', 'parent': 'Staphylococcus', 'value': 0.951149690645489}, {'name': 'Staphylococcus_capitis_subsp_capitis', 'id': 'Staphylococcus_capitis_subsp_capitis', 'parent': 'Staphylococcus_capitis', 'value': 0.1846892603195124}, {'name': 'Staphylococcus_aureus', 'id': 'Staphylococcus_aureus', 'parent': 'Staphylococcus', 'value': 0.7202881152460985}, {'name': 'Staphylococcus_hominis', 'id': 'Staphylococcus_hominis', 'parent': 'Staphylococcus', 'value': 0.3555268261150615}, {'name': 'Staphylococcus_hominis_subsp_hominis', 'id': 'Staphylococcus_hominis_subsp_hominis', 'parent': 'Staphylococcus_hominis', 'value': 0.3555268261150615}, {'name': 'Staphylococcus_warneri', 'id': 'Staphylococcus_warneri', 'parent': 'Staphylococcus', 'value': 0.2077754178594515}, {'name': 'Staphylococcus_saprophyticus', 'id': 'Staphylococcus_saprophyticus', 'parent': 'Staphylococcus', 'value': 0.08772739865176842}, {'name': 'Staphylococcus_pasteuri', 'id': 'Staphylococcus_pasteuri', 'parent': 'Staphylococcus', 'value': 0.07387570412780498}, {'name': 'Staphylococcus_pettenkoferi', 'id': 'Staphylococcus_pettenkoferi', 'parent': 'Staphylococcus', 'value': 0.018468926031951244}, {'name': 'Bacillaceae', 'id': 'Bacillaceae', 'parent': 'Bacillales'}, {'name': 'Bacillus', 'id': 'Bacillus', 'parent': 'Bacillaceae'}, {'name': 'Bacillus_coagulans', 'id': 'Bacillus_coagulans', 'parent': 'Bacillus', 'value': 0.027703389047926862}, {'name': 'Bacillus_smithii', 'id': 'Bacillus_smithii', 'parent': 'Bacillus', 'value': 0.013851694523963431}, {'name': 'Lactobacillales', 'id': 'Lactobacillales', 'parent': 'Bacilli', 'value': 2.243974512882076}, {'name': 'Streptococcaceae', 'id': 'Streptococcaceae', 'parent': 'Lactobacillales', 'value': 1.999261242958722}, {'name': 'Streptococcus', 'id': 'Streptococcus', 'parent': 'Streptococcaceae', 'value': 1.9300027703389049}, {'name': 'Streptococcus_mitis', 'id': 'Streptococcus_mitis', 'parent': 'Streptococcus', 'value': 0.5171299288946348}, {'name': 'Streptococcus_pneumoniae', 'id': 'Streptococcus_pneumoniae', 'parent': 'Streptococcus', 'value': 0.14775140825560995}, {'name': 'Streptococcus_salivarius', 'id': 'Streptococcus_salivarius', 'parent': 'Streptococcus', 'value': 0.12466525071567089}, {'name': 'Streptococcus_oralis', 'id': 'Streptococcus_oralis', 'parent': 'Streptococcus', 'value': 0.12466525071567089}, {'name': 'Streptococcus_oralis_subsp_tigurinus', 'id': 'Streptococcus_oralis_subsp_tigurinus', 'parent': 'Streptococcus_oralis', 'value': 0.03693785206390249}, {'name': 'Streptococcus_sp_oral_taxon_431', 'id': 'Streptococcus_sp_oral_taxon_431', 'parent': 'Streptococcus', 'value': 0.10619632468371965}, {'name': 'Streptococcus_pseudopneumoniae', 'id': 'Streptococcus_pseudopneumoniae', 'parent': 'Streptococcus', 'value': 0.0923446301597562}, {'name': 'Streptococcus_sanguinis', 'id': 'Streptococcus_sanguinis', 'parent': 'Streptococcus', 'value': 0.08772739865176842}, {'name': 'Streptococcus_thermophilus', 'id': 'Streptococcus_thermophilus', 'parent': 'Streptococcus', 'value': 0.06925847261981717}, {'name': 'Streptococcus_sp_I-P16', 'id': 'Streptococcus_sp_I-P16', 'parent': 'Streptococcus', 'value': 0.055406778095853725}, {'name': 'Streptococcus_parasanguinis', 'id': 'Streptococcus_parasanguinis', 'parent': 'Streptococcus', 'value': 0.050789546587865914}, {'name': 'Streptococcus_gordonii', 'id': 'Streptococcus_gordonii', 'parent': 'Streptococcus', 'value': 0.0415550835718903}, {'name': 'Streptococcus_sp_I-G2', 'id': 'Streptococcus_sp_I-G2', 'parent': 'Streptococcus', 'value': 0.0415550835718903}, {'name': 'Streptococcus_sp_A12', 'id': 'Streptococcus_sp_A12', 'parent': 'Streptococcus', 'value': 0.03693785206390249}, {'name': 'Streptococcus_sp_NPS_308', 'id': 'Streptococcus_sp_NPS_308', 'parent': 'Streptococcus', 'value': 0.027703389047926862}, {'name': 'Lactococcus', 'id': 'Lactococcus', 'parent': 'Streptococcaceae'}, {'name': 'Lactococcus_lactis', 'id': 'Lactococcus_lactis', 'parent': 'Lactococcus', 'value': 0.060024009603841535}, {'name': 'Lactobacillaceae', 'id': 'Lactobacillaceae', 'parent': 'Lactobacillales'}, {'name': 'Lactobacillus', 'id': 'Lactobacillus', 'parent': 'Lactobacillaceae'}, {'name': 'Lactobacillus_acidophilus', 'id': 'Lactobacillus_acidophilus', 'parent': 'Lactobacillus', 'value': 0.009234463015975622}, {'name': 'Lactobacillus_sakei', 'id': 'Lactobacillus_sakei', 'parent': 'Lactobacillus'}, {'name': 'Lactobacillus_sakei_subsp_sakei', 'id': 'Lactobacillus_sakei_subsp_sakei', 'parent': 'Lactobacillus_sakei', 'value': 0.004617231507987811}, {'name': 'Leuconostocaceae', 'id': 'Leuconostocaceae', 'parent': 'Lactobacillales'}, {'name': 'Leuconostoc', 'id': 'Leuconostoc', 'parent': 'Leuconostocaceae'}, {'name': 'Leuconostoc_gelidum', 'id': 'Leuconostoc_gelidum', 'parent': 'Leuconostoc', 'value': 0.027703389047926862}, {'name': 'Leuconostoc_gelidum_subsp_gasicomitatum', 'id': 'Leuconostoc_gelidum_subsp_gasicomitatum', 'parent': 'Leuconostoc_gelidum', 'value': 0.004617231507987811}, {'name': 'Leuconostoc_garlicum', 'id': 'Leuconostoc_garlicum', 'parent': 'Leuconostoc', 'value': 0.013851694523963431}, {'name': 'Aerococcaceae', 'id': 'Aerococcaceae', 'parent': 'Lactobacillales'}, {'name': 'Aerococcus', 'id': 'Aerococcus', 'parent': 'Aerococcaceae'}, {'name': 'Aerococcus_christensenii', 'id': 'Aerococcus_christensenii', 'parent': 'Aerococcus', 'value': 0.009234463015975622}, {'name': 'Tissierellia', 'id': 'Tissierellia', 'parent': 'Firmicutes', 'value': 0.2123926493674393}, {'name': 'Tissierellales', 'id': 'Tissierellales', 'parent': 'Tissierellia', 'value': 0.2123926493674393}, {'name': 'Peptoniphilaceae', 'id': 'Peptoniphilaceae', 'parent': 'Tissierellales', 'value': 0.2123926493674393}, {'name': 'Finegoldia', 'id': 'Finegoldia', 'parent': 'Peptoniphilaceae', 'value': 0.12466525071567089}, {'name': 'Finegoldia_magna', 'id': 'Finegoldia_magna', 'parent': 'Finegoldia', 'value': 0.12466525071567089}, {'name': 'Anaerococcus', 'id': 'Anaerococcus', 'parent': 'Peptoniphilaceae', 'value': 0.06925847261981717}, {'name': 'Anaerococcus_prevotii', 'id': 'Anaerococcus_prevotii', 'parent': 'Anaerococcus', 'value': 0.050789546587865914}, {'name': 'Anaerococcus_mediterraneensis', 'id': 'Anaerococcus_mediterraneensis', 'parent': 'Anaerococcus', 'value': 0.018468926031951244}, {'name': 'Parvimonas', 'id': 'Parvimonas', 'parent': 'Peptoniphilaceae', 'value': 0.013851694523963431}, {'name': 'Parvimonas_micra', 'id': 'Parvimonas_micra', 'parent': 'Parvimonas', 'value': 0.013851694523963431}, {'name': 'Murdochiella', 'id': 'Murdochiella', 'parent': 'Peptoniphilaceae', 'value': 0.004617231507987811}, {'name': 'Murdochiella_vaginalis', 'id': 'Murdochiella_vaginalis', 'parent': 'Murdochiella', 'value': 0.004617231507987811}, {'name': 'Negativicutes', 'id': 'Negativicutes', 'parent': 'Firmicutes'}, {'name': 'Veillonellales', 'id': 'Veillonellales', 'parent': 'Negativicutes', 'value': 0.11543078769969527}, {'name': 'Veillonellaceae', 'id': 'Veillonellaceae', 'parent': 'Veillonellales', 'value': 0.11543078769969527}, {'name': 'Veillonella', 'id': 'Veillonella', 'parent': 'Veillonellaceae', 'value': 0.09696186166774402}, {'name': 'Veillonella_parvula', 'id': 'Veillonella_parvula', 'parent': 'Veillonella', 'value': 0.0923446301597562}, {'name': 'Proteobacteria', 'id': 'Proteobacteria', 'parent': 'Bacteria'}, {'name': 'Gammaproteobacteria', 'id': 'Gammaproteobacteria', 'parent': 'Proteobacteria'}, {'name': 'Enterobacterales', 'id': 'Enterobacterales', 'parent': 'Gammaproteobacteria'}, {'name': 'Enterobacteriaceae', 'id': 'Enterobacteriaceae', 'parent': 'Enterobacterales'}, {'name': 'Klebsiella', 'id': 'Klebsiella', 'parent': 'Enterobacteriaceae'}, {'name': 'Klebsiella_pneumoniae', 'id': 'Klebsiella_pneumoniae', 'parent': 'Klebsiella'}, {'name': 'Klebsiella_pneumoniae_subsp_pneumoniae', 'id': 'Klebsiella_pneumoniae_subsp_pneumoniae', 'parent': 'Klebsiella_pneumoniae', 'value': 0.6187090220703666}, {'name': 'Enterobacter', 'id': 'Enterobacter', 'parent': 'Enterobacteriaceae'}, {'name': "Enterobacter_cloacae_complex_'Hoffmann_cluster_III'", 'id': "Enterobacter_cloacae_complex_'Hoffmann_cluster_III'", 'parent': 'Enterobacter', 'value': 0.004617231507987811}, {'name': 'Yersiniaceae', 'id': 'Yersiniaceae', 'parent': 'Enterobacterales'}, {'name': 'Rahnella', 'id': 'Rahnella', 'parent': 'Yersiniaceae', 'value': 0.03693785206390249}, {'name': 'Rahnella_aquatilis', 'id': 'Rahnella_aquatilis', 'parent': 'Rahnella', 'value': 0.009234463015975622}, {'name': 'Pseudomonadales', 'id': 'Pseudomonadales', 'parent': 'Gammaproteobacteria'}, {'name': 'Pseudomonadaceae', 'id': 'Pseudomonadaceae', 'parent': 'Pseudomonadales'}, {'name': 'Pseudomonas', 'id': 'Pseudomonas', 'parent': 'Pseudomonadaceae'}, {'name': 'Pseudomonas_antarctica', 'id': 'Pseudomonas_antarctica', 'parent': 'Pseudomonas', 'value': 0.5448333179425617}, {'name': 'Pseudomonas_sp_URMO17WK12:I11', 'id': 'Pseudomonas_sp_URMO17WK12:I11', 'parent': 'Pseudomonas', 'value': 0.0784929356357928}, {'name': 'Pseudomonas_sp_Lz4W', 'id': 'Pseudomonas_sp_Lz4W', 'parent': 'Pseudomonas', 'value': 0.013851694523963431}, {'name': 'Pseudomonas_sp_S-6-2', 'id': 'Pseudomonas_sp_S-6-2', 'parent': 'Pseudomonas', 'value': 0.027703389047926862}, {'name': 'Moraxellaceae', 'id': 'Moraxellaceae', 'parent': 'Pseudomonadales', 'value': 0.6187090220703666}, {'name': 'Acinetobacter', 'id': 'Acinetobacter', 'parent': 'Moraxellaceae'}, {'name': 'Acinetobacter_pittii', 'id': 'Acinetobacter_pittii', 'parent': 'Acinetobacter', 'value': 0.06464124111182935}, {'name': 'Acinetobacter_johnsonii', 'id': 'Acinetobacter_johnsonii', 'parent': 'Acinetobacter', 'value': 0.11081355619170745}, {'name': 'Acinetobacter_junii', 'id': 'Acinetobacter_junii', 'parent': 'Acinetobacter', 'value': 0.050789546587865914}, {'name': 'Acinetobacter_schindleri', 'id': 'Acinetobacter_schindleri', 'parent': 'Acinetobacter', 'value': 0.018468926031951244}, {'name': 'Moraxella', 'id': 'Moraxella', 'parent': 'Moraxellaceae', 'value': 0.24009603841536614}, {'name': 'Moraxella_osloensis', 'id': 'Moraxella_osloensis', 'parent': 'Moraxella', 'value': 0.24009603841536614}, {'name': 'Pasteurellales', 'id': 'Pasteurellales', 'parent': 'Gammaproteobacteria'}, {'name': 'Pasteurellaceae', 'id': 'Pasteurellaceae', 'parent': 'Pasteurellales'}, {'name': 'Haemophilus', 'id': 'Haemophilus', 'parent': 'Pasteurellaceae', 'value': 0.244713269923354}, {'name': 'Haemophilus_parainfluenzae', 'id': 'Haemophilus_parainfluenzae', 'parent': 'Haemophilus', 'value': 0.170837565795549}, {'name': 'Haemophilus_influenzae', 'id': 'Haemophilus_influenzae', 'parent': 'Haemophilus', 'value': 0.055406778095853725}, {'name': 'Alphaproteobacteria', 'id': 'Alphaproteobacteria', 'parent': 'Proteobacteria'}, {'name': 'Rhodobacterales', 'id': 'Rhodobacterales', 'parent': 'Alphaproteobacteria', 'value': 3.2412965186074434}, {'name': 'Rhodobacteraceae', 'id': 'Rhodobacteraceae', 'parent': 'Rhodobacterales', 'value': 3.2412965186074434}, {'name': 'Paracoccus', 'id': 'Paracoccus', 'parent': 'Rhodobacteraceae', 'value': 2.059285252562564}, {'name': 'Paracoccus_yeei', 'id': 'Paracoccus_yeei', 'parent': 'Paracoccus', 'value': 1.2328008126327457}, {'name': 'Paracoccus_contaminans', 'id': 'Paracoccus_contaminans', 'parent': 'Paracoccus', 'value': 0.18930649182750026}, {'name': 'Paracoccus_aminovorans', 'id': 'Paracoccus_aminovorans', 'parent': 'Paracoccus', 'value': 0.11543078769969527}, {'name': 'Rhizobiales', 'id': 'Rhizobiales', 'parent': 'Alphaproteobacteria'}, {'name': 'Bradyrhizobiaceae', 'id': 'Bradyrhizobiaceae', 'parent': 'Rhizobiales'}, {'name': 'Bradyrhizobium', 'id': 'Bradyrhizobium', 'parent': 'Bradyrhizobiaceae', 'value': 1.440576230492197}, {'name': 'Bradyrhizobium_sp_SK17', 'id': 'Bradyrhizobium_sp_SK17', 'parent': 'Bradyrhizobium', 'value': 0.9927047742173793}, {'name': 'Rhizobiaceae', 'id': 'Rhizobiaceae', 'parent': 'Rhizobiales'}, {'name': 'Rhizobium', 'id': 'Rhizobium', 'parent': 'Rhizobiaceae'}, {'name': 'Rhizobium_sp_S41', 'id': 'Rhizobium_sp_S41', 'parent': 'Rhizobium', 'value': 0.009234463015975622}, {'name': 'Methylobacteriaceae', 'id': 'Methylobacteriaceae', 'parent': 'Rhizobiales'}, {'name': 'Methylobacterium', 'id': 'Methylobacterium', 'parent': 'Methylobacteriaceae', 'value': 0.4524886877828055}, {'name': 'Methylobacterium_oryzae', 'id': 'Methylobacterium_oryzae', 'parent': 'Methylobacterium', 'value': 0.055406778095853725}, {'name': 'Methylobacterium_phyllosphaerae', 'id': 'Methylobacterium_phyllosphaerae', 'parent': 'Methylobacterium', 'value': 0.027703389047926862}, {'name': 'Caulobacterales', 'id': 'Caulobacterales', 'parent': 'Alphaproteobacteria'}, {'name': 'Caulobacteraceae', 'id': 'Caulobacteraceae', 'parent': 'Caulobacterales'}, {'name': 'Brevundimonas', 'id': 'Brevundimonas', 'parent': 'Caulobacteraceae'}, {'name': 'Brevundimonas_vesicularis', 'id': 'Brevundimonas_vesicularis', 'parent': 'Brevundimonas', 'value': 0.03232062055591468}, {'name': 'Brevundimonas_sp_GW460-12-10-14-LB2', 'id': 'Brevundimonas_sp_GW460-12-10-14-LB2', 'parent': 'Brevundimonas', 'value': 0.018468926031951244}, {'name': 'Betaproteobacteria', 'id': 'Betaproteobacteria', 'parent': 'Proteobacteria'}, {'name': 'Burkholderiales', 'id': 'Burkholderiales', 'parent': 'Betaproteobacteria'}, {'name': 'Burkholderiaceae', 'id': 'Burkholderiaceae', 'parent': 'Burkholderiales', 'value': 2.7149321266968327}, {'name': 'Ralstonia', 'id': 'Ralstonia', 'parent': 'Burkholderiaceae', 'value': 2.19318496629421}, {'name': 'Ralstonia_pickettii', 'id': 'Ralstonia_pickettii', 'parent': 'Ralstonia', 'value': 1.9715578539107952}, {'name': 'Ralstonia_mannitolilytica', 'id': 'Ralstonia_mannitolilytica', 'parent': 'Ralstonia', 'value': 0.055406778095853725}, {'name': 'Paraburkholderia', 'id': 'Paraburkholderia', 'parent': 'Burkholderiaceae'}, {'name': 'Paraburkholderia_fungorum', 'id': 'Paraburkholderia_fungorum', 'parent': 'Paraburkholderia', 'value': 0.22624434389140274}, {'name': 'Comamonadaceae', 'id': 'Comamonadaceae', 'parent': 'Burkholderiales'}, {'name': 'Acidovorax', 'id': 'Acidovorax', 'parent': 'Comamonadaceae'}, {'name': 'Acidovorax_sp_KKS102', 'id': 'Acidovorax_sp_KKS102', 'parent': 'Acidovorax', 'value': 0.11543078769969527}, {'name': 'Delftia', 'id': 'Delftia', 'parent': 'Comamonadaceae', 'value': 0.13851694523963434}, {'name': 'Delftia_tsuruhatensis', 'id': 'Delftia_tsuruhatensis', 'parent': 'Delftia', 'value': 0.0461723150798781}, {'name': 'Neisseriales', 'id': 'Neisseriales', 'parent': 'Betaproteobacteria'}, {'name': 'Neisseriaceae', 'id': 'Neisseriaceae', 'parent': 'Neisseriales', 'value': 0.30473727952719554}, {'name': 'Neisseria', 'id': 'Neisseria', 'parent': 'Neisseriaceae', 'value': 0.2908855850032321}, {'name': 'Neisseria_sicca', 'id': 'Neisseria_sicca', 'parent': 'Neisseria', 'value': 0.09696186166774402}, {'name': 'Neisseria_meningitidis', 'id': 'Neisseria_meningitidis', 'parent': 'Neisseria', 'value': 0.0831101671437806}, {'name': 'Neisseria_elongata', 'id': 'Neisseria_elongata', 'parent': 'Neisseria', 'value': 0.027703389047926862}, {'name': 'Neisseria_elongata_subsp_glycolytica', 'id': 'Neisseria_elongata_subsp_glycolytica', 'parent': 'Neisseria_elongata', 'value': 0.027703389047926862}, {'name': 'Epsilonproteobacteria', 'id': 'Epsilonproteobacteria', 'parent': 'Proteobacteria'}, {'name': 'Campylobacterales', 'id': 'Campylobacterales', 'parent': 'Epsilonproteobacteria'}, {'name': 'Campylobacteraceae', 'id': 'Campylobacteraceae', 'parent': 'Campylobacterales'}, {'name': 'Campylobacter', 'id': 'Campylobacter', 'parent': 'Campylobacteraceae'}, {'name': 'Campylobacter_hominis', 'id': 'Campylobacter_hominis', 'parent': 'Campylobacter', 'value': 0.018468926031951244}, {'name': 'Bacteroidetes', 'id': 'Bacteroidetes', 'parent': 'Bacteria'}, {'name': 'Bacteroidia', 'id': 'Bacteroidia', 'parent': 'Bacteroidetes'}, {'name': 'Bacteroidales', 'id': 'Bacteroidales', 'parent': 'Bacteroidia'}, {'name': 'Prevotellaceae', 'id': 'Prevotellaceae', 'parent': 'Bacteroidales'}, {'name': 'Prevotella', 'id': 'Prevotella', 'parent': 'Prevotellaceae'}, {'name': 'Prevotella_denticola', 'id': 'Prevotella_denticola', 'parent': 'Prevotella', 'value': 0.027703389047926862}, {'name': 'Cytophagia', 'id': 'Cytophagia', 'parent': 'Bacteroidetes'}, {'name': 'Cytophagales', 'id': 'Cytophagales', 'parent': 'Cytophagia'}, {'name': 'Cytophagaceae', 'id': 'Cytophagaceae', 'parent': 'Cytophagales'}, {'name': 'Spirosoma', 'id': 'Spirosoma', 'parent': 'Cytophagaceae'}, {'name': 'Spirosoma_rigui', 'id': 'Spirosoma_rigui', 'parent': 'Spirosoma', 'value': 0.050789546587865914}, {'name': 'Fusobacteria', 'id': 'Fusobacteria', 'parent': 'Bacteria', 'value': 0.1846892603195124}, {'name': 'Fusobacteriia', 'id': 'Fusobacteriia', 'parent': 'Fusobacteria', 'value': 0.1846892603195124}, {'name': 'Fusobacteriales', 'id': 'Fusobacteriales', 'parent': 'Fusobacteriia', 'value': 0.1846892603195124}, {'name': 'Fusobacteriaceae', 'id': 'Fusobacteriaceae', 'parent': 'Fusobacteriales', 'value': 0.14313417674762213}, {'name': 'Fusobacterium', 'id': 'Fusobacterium', 'parent': 'Fusobacteriaceae', 'value': 0.14313417674762213}, {'name': 'Fusobacterium_periodonticum', 'id': 'Fusobacterium_periodonticum', 'parent': 'Fusobacterium', 'value': 0.0784929356357928}, {'name': 'Fusobacterium_nucleatum', 'id': 'Fusobacterium_nucleatum', 'parent': 'Fusobacterium'}, {'name': 'Fusobacterium_nucleatum_subsp_vincentii', 'id': 'Fusobacterium_nucleatum_subsp_vincentii', 'parent': 'Fusobacterium_nucleatum', 'value': 0.02308615753993905}, {'name': 'Leptotrichiaceae', 'id': 'Leptotrichiaceae', 'parent': 'Fusobacteriales'}, {'name': 'Leptotrichia', 'id': 'Leptotrichia', 'parent': 'Leptotrichiaceae'}, {'name': 'Leptotrichia_sp_oral_taxon_212', 'id': 'Leptotrichia_sp_oral_taxon_212', 'parent': 'Leptotrichia', 'value': 0.027703389047926862}, {'name': 'Viruses', 'id': 'Viruses', 'parent': 'root'}, {'name': 'Poxviridae', 'id': 'Poxviridae', 'parent': 'Viruses'}, {'name': 'BeAn_58058_virus', 'id': 'BeAn_58058_virus', 'parent': 'Poxviridae', 'value': 0.18930649182750026}, {'name': 'Caudovirales', 'id': 'Caudovirales', 'parent': 'Viruses'}, {'name': 'Siphoviridae', 'id': 'Siphoviridae', 'parent': 'Caudovirales'}, {'name': 'Pa6virus', 'id': 'Pa6virus', 'parent': 'Siphoviridae', 'value': 0.0415550835718903}, {'name': 'Propionibacterium_virus_PHL060L00', 'id': 'Propionibacterium_virus_PHL060L00', 'parent': 'Pa6virus', 'value': 0.004617231507987811}, {'name': 'Propionibacterium_virus_P144', 'id': 'Propionibacterium_virus_P144', 'parent': 'Pa6virus', 'value': 0.004617231507987811}, {'name': 'Propionibacterium_virus_PHL111M01', 'id': 'Propionibacterium_virus_PHL111M01', 'parent': 'Pa6virus', 'value': 0.004617231507987811}, {'name': 'Propionibacterium_virus_PHL113M01', 'id': 'Propionibacterium_virus_PHL113M01', 'parent': 'Pa6virus', 'value': 0.004617231507987811}, {'name': 'Propionibacterium_virus_Stormborn', 'id': 'Propionibacterium_virus_Stormborn', 'parent': 'Pa6virus', 'value': 0.004617231507987811}, {'name': 'Staphylococcus_phage_StB20-like', 'id': 'Staphylococcus_phage_StB20-like', 'parent': 'Siphoviridae', 'value': 0.009234463015975622}, {'name': 'Staphylococcus_phage_StB12', 'id': 'Staphylococcus_phage_StB12', 'parent': 'Siphoviridae', 'value': 0.004617231507987811}, {'name': 'Propionibacterium_phage_Moyashi', 'id': 'Propionibacterium_phage_Moyashi', 'parent': 'Siphoviridae', 'value': 0.004617231507987811}, {'name': 'Propionibacterium_phage_PHL067M10', 'id': 'Propionibacterium_phage_PHL067M10', 'parent': 'Siphoviridae', 'value': 0.004617231507987811}, {'name': 'Propionibacterium_phage_PAC1', 'id': 'Propionibacterium_phage_PAC1', 'parent': 'Siphoviridae', 'value': 0.004617231507987811}, {'name': 'Gordonia_phage_SoilAssassin', 'id': 'Gordonia_phage_SoilAssassin', 'parent': 'Siphoviridae', 'value': 0.004617231507987811}, {'name': 'Propionibacterium_phage_PHL199', 'id': 'Propionibacterium_phage_PHL199', 'parent': 'Siphoviridae', 'value': 0.004617231507987811}, {'name': 'Phietavirus', 'id': 'Phietavirus', 'parent': 'Siphoviridae', 'value': 0.018468926031951244}, {'name': 'Staphylococcus_virus_IPLA7', 'id': 'Staphylococcus_virus_IPLA7', 'parent': 'Phietavirus', 'value': 0.009234463015975622}, {'name': 'Staphylococcus_virus_CNPH82', 'id': 'Staphylococcus_virus_CNPH82', 'parent': 'Phietavirus', 'value': 0.004617231507987811}, {'name': 'Staphylococcus_virus_PH15', 'id': 'Staphylococcus_virus_PH15', 'parent': 'Phietavirus', 'value': 0.004617231507987811}, {'name': 'Baculoviridae', 'id': 'Baculoviridae', 'parent': 'Viruses'}, {'name': 'Alphabaculovirus', 'id': 'Alphabaculovirus', 'parent': 'Baculoviridae', 'value': 0.0415550835718903}, {'name': 'Mamestra_configurata_nucleopolyhedrovirus_A', 'id': 'Mamestra_configurata_nucleopolyhedrovirus_A', 'parent': 'Alphabaculovirus', 'value': 0.03693785206390249}, {'name': 'Herpesvirales', 'id': 'Herpesvirales', 'parent': 'Viruses'}, {'name': 'Herpesviridae', 'id': 'Herpesviridae', 'parent': 'Herpesvirales'}, {'name': 'Roseolovirus', 'id': 'Roseolovirus', 'parent': 'Herpesviridae'}, {'name': 'Human_betaherpesvirus_7', 'id': 'Human_betaherpesvirus_7', 'parent': 'Roseolovirus', 'value': 0.004617231507987811}, {'name': 'Partitiviridae', 'id': 'Partitiviridae', 'parent': 'Viruses', 'value': 0.027703389047926862}, {'name': 'Betapartitivirus', 'id': 'Betapartitivirus', 'parent': 'Partitiviridae', 'value': 0.018468926031951244}, {'name': 'Hop_trefoil_cryptic_virus_2', 'id': 'Hop_trefoil_cryptic_virus_2', 'parent': 'Betapartitivirus', 'value': 0.013851694523963431}, {'name': 'Rosellinia_necatrix_partitivirus_6', 'id': 'Rosellinia_necatrix_partitivirus_6', 'parent': 'Betapartitivirus', 'value': 0.004617231507987811}, {'name': 'Retroviridae', 'id': 'Retroviridae', 'parent': 'Viruses', 'value': 0.009234463015975622}, {'name': 'Human_endogenous_retrovirus_K', 'id': 'Human_endogenous_retrovirus_K', 'parent': 'Retroviridae', 'value': 0.009234463015975622}, {'name': 'Caulimoviridae', 'id': 'Caulimoviridae', 'parent': 'Viruses'}, {'name': 'Solendovirus', 'id': 'Solendovirus', 'parent': 'Caulimoviridae', 'value': 0.004617231507987811}, {'name': 'Tobacco_vein_clearing_virus', 'id': 'Tobacco_vein_clearing_virus', 'parent': 'Solendovirus', 'value': 0.004617231507987811}, {'name': 'Bunyavirales', 'id': 'Bunyavirales', 'parent': 'Viruses'}, {'name': 'Tospoviridae', 'id': 'Tospoviridae', 'parent': 'Bunyavirales'}, {'name': 'Orthotospovirus', 'id': 'Orthotospovirus', 'parent': 'Tospoviridae'}, {'name': 'Pepper_chlorotic_spot_virus', 'id': 'Pepper_chlorotic_spot_virus', 'parent': 'Orthotospovirus', 'value': 0.009234463015975622}, {'name': 'Microviridae', 'id': 'Microviridae', 'parent': 'Viruses', 'value': 0.004617231507987811}, {'name': 'Phix174microvirus', 'id': 'Phix174microvirus', 'parent': 'Microviridae', 'value': 0.004617231507987811}, {'name': 'Enterobacteria_phage_phiX174_sensu_lato', 'id': 'Enterobacteria_phage_phiX174_sensu_lato', 'parent': 'Phix174microvirus', 'value': 0.004617231507987811}];


const baseOptions: Highcharts.Options = {

    chart: {
        height: '100%'
    },

    title: {
        text: 'Sample Taxonomy'
    },
    tooltip: {
        headerFormat: "",
        pointFormat: 'The proportion of <b>{point.name}</b> is <b>{point.value}%</b>',
        valueDecimals: 4,
    }
}

const sampleOptions = (data: Highcharts.PointOptionsObject[]): Highcharts.Options => {
  const seriesOptions: Highcharts.Options = {
    legend: {
      enabled: false,
    },
    series: [{
        type: "sunburst",
        data: data,
        allowTraversingTree: true,
        cursor: 'pointer',
        dataLabels: {
            format: '{point.name}',
            filter: {
                property: 'innerArcLength',
                operator: '>',
                value: 16
            }
        },
      colorByPoint: true,
    }],
  };

  return seriesOptions;
};

export interface SampleTaxonomyProps extends ChartRefProps {
  data: SampleTaxonomyType;
}

export interface SampleSimilarityState {
  activeTool: string;
}

export class SampleTaxonomyContainer extends React.Component<SampleTaxonomyProps, SampleSimilarityState> {
  constructor(props: SampleTaxonomyProps) {
    super(props);

    this.handleSourceChange = this.handleSourceChange.bind(this);

    this.state = {
      activeTool: Object.keys(this.props.data)[0],
    };
  }

  handleSourceChange(newSource: string) {
    this.setState({
      activeTool: newSource,
    });
  }

  render() {
    const data = this.props.data,
          activeTool = this.state.activeTool,
          seriesOptions = sampleOptions(data[this.state.activeTool]),
          chartOptions = Object.assign(baseOptions, seriesOptions);
    return (
      <Row>
        <Col lg={9}>
          <HighChartsPlot
            chartId="sunburst-taxonomy"
            options={chartOptions}
            chartRef={this.props.chartRef}
          />
        </Col>
        <Col lg={3}>
          <SampleTaxonomyControls
            sources={Object.keys(data)}
            activeSource={activeTool}
            handleSourceChange={this.handleSourceChange}
          />
        </Col>
      </Row>
    );
  }
}
